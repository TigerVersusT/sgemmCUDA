# gemm 学习记录

## 矩阵乘法分析
对于矩阵${A}和${B}的乘法运算，如果根据矩阵乘法定义来计算结果${C}会造成严重的内存带宽浪费，分析如下：

以4X4矩阵乘法为例：
$A=\begin{bmatrix}a_{11}&a_{12}&a_{13}&a_{14}\\a_{21}&a_{22}&a_{23}&a_{24}\\a_{31}&a_{32}&a_{33}&a_{34}\\a_{41}&a_{42}&a_{43}&a_{44}\end{bmatrix}$

$B=\begin{bmatrix}b_{11}&b_{12}&b_{13}&b_{14}\\b_{21}&b_{22}&b_{23}&b_{24}\\b_{31}&b_{32}&b_{33}&b_{34}\\b_{41}&b_{42}&b_{43}&b_{44}\end{bmatrix}$

$C=\begin{bmatrix}a_{11}\ast b_{11}+a_{12}\ast b_{21}+a_{13}\ast b_{31}+a_{14}\ast b_{41}&.&.&.\\a_{21}\ast b_{11}+a_{22}\ast b_{21}+a_{23}\ast b_{31}+a_{24}\ast b_{41}&.&.&.\\a_{31}\ast b_{11}+a_{32}\ast b_{21}+a_{33}\ast b_{31}+a_{34}\ast b_{41}&.&.&.\\a_{41}\ast b_{11}+a_{42}\ast b_{21}+a_{43}\ast b_{31}+a_{44}\ast b_{41}&.&.&.\end{bmatrix}$

可以看出，由于每次计算一个点都需要完整读取所有的相关数据，算法会造成重复的全局内存读取，从而降低kernel的性能。那么合理的优化思路就是对矩阵元素进行暂存
，假设矩阵${A}和${B}的值都在寄存器中，直接用公式计算即可。然而寄存器是不可能暂存这么多数据的，解决的办法就是矩阵分块，矩阵分块的一个绝佳性质是通过分块
降低矩阵运算的规模从而支持缓存矩阵元素降低全局内存访问，通过合理的分块组织，矩阵乘法中所有的元素都可以依次缓存在寄存器中并进行高效的计算。

## 通过矩阵分块乘法减少规模

![avatar](data:image/png;base64,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aRCBSQKCYxKXiwnMFxAc8+0i7xQckZpmERgvIDjGW7mSwCIBwbGIL+xmwRFGaRCBSQKCYxKXiwnMFxAc8+0i7xQckZpmERgvIDjGW7mSwCIBwbGIL+xmwRFGaRCBSQKCYxKXiwnMFxAc8+0i7xQckZpmERgvIDjGW7mSwCIBwbGIL+xmwRFGaRCBSQKCYxKXiwnMFxAc8+0i7xQckZpmERgvIDjGW7mSwCIBwbGIL+xmwRFGaRCBSQKCYxKXiwnMFxAc8+0i7xQckZpmERgvIDjGW7mSwCIBwbGIL+xmwRFGaRCBSQKCYxKXiwnMFxAc8+0i7xQckZpmERgvIDjGW7mSwCIBwbGIL+xmwRFGaRCBSQKCYxKXiwnMFxAc8+0i7xQckZpmERgvIDjGW7mSwCIBwbGIL+xmwRFGaRCBSQKCYxKXiwnMFxAc8+0i7xQckZpmERgvIDjGW7mSwCIBwbGIL+xmwRFGaRCBSQKCYxKXiwnMFxAc8+0i7xQckZpmERgvIDjGW7mSwCIBwbGIL+xmwRFGaRCBSQKCYxKXiwnMFxAc8+0i7xQckZpmERgvIDjGW7mSwCIBwbGIL+xmwRFGaRCBSQKCYxKXiwnMFxAc8+0i7xQckZpmERgvIDjGW7mSwCIBwbGIL+xmwRFGaRCBSQKCYxKXiwnMFxAc8+0i7xQckZpmERgvIDjGW7mSwCIBwbGIL+xmwRFGaRCBSQKCYxKXiwnMFxAc8+0i7xQckZpmERgvIDjGW7mSwCIBwbGIL+xmwRFGaRCBSQKCYxKXiwnMFxAc8+0i7xQckZpmERgvIDjGW7mSwCIBwbGIL+xmwRFGaRCBSQKCYxKXiwnMFxAc8+0i7xQckZpmERgvIDjGW7mSwCIBwbGIL+xmwRFGaRCBSQKCYxKXiwnMFxAc8+0i7xQckZpmERgvIDjGW7mSwCIBwbGIL+xmwRFGaRCBSQKCYxKXiwnMFxAc8+0i7xQckZpmERgvIDjGW7mSwCIBwbGIL+xmwRFGaRCBSQKCYxKXiwnMFxAc8+0i7xQckZpmERgvIDjGW7mSwCIBwbGIL+xmwRFGaRCBSQKCYxKXiwnMFxAc8+0i7xQckZpmERgvIDjGW7mSwCIBwbGIL+xmwRFGaRCBSQKCYxKXiwnMFxAc8+0i7xQckZpmERgvIDjGW7mSwCIBwbGIL+xmwRFG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)

上图一个矩阵分块的例子，通过矩阵分块乘法，矩阵${C}中红色的矩阵块只需要对应${A}和${B}中的子矩阵相乘即可得出结果，显然，需要暂存的数据大大地减少了，只要能够使用寄存器
缓存对应${A}和${B}中的子矩阵，就能够一次读取需要处理地数据从而节约内存带宽。但是对于较大规模的矩阵${A}和${B}，一次矩阵分块并不能减少太多数据。为例解决这个问题可以
进一步进行矩阵分块。

![avatar](data:image/png;base64,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)

进一步矩阵分块效果如上图，根据矩阵的分块乘法，采用这种分块矩阵${C}可以由矩阵${A}和矩阵${B}各取一个小块进行计算，累加所有的临时结果即可得到最终的矩阵${C}
进一步的分块甚至可以不需要暂存临时结果：

![avatar](data:image/png;base64,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)

## 矩阵分块结合内存层次

从上图可见，经过进一步的应用矩阵分块削减矩阵乘法的规模，算法的一次运行对矩阵元素的访问越来越集中，
从最开始计算一个点的结果需要读取矩阵${A}的一行和矩阵${B}的一列到目前的读取${A}和${B}的一小块数据，算法的局部性进一步增强。

由于一次乘法所需的数据量较小，完全可以把矩阵${A}和${B}中的一小块读取到寄存器中，一次计算出${C}中一小块的结果。

考虑到GPU的全局内存访问和寄存器访问的延迟相差数百倍，如果每次都从全局内存中读取${A}和${B}的一小块来计算，会出现处理器快速完成小矩阵乘法后大量时间在等待数据的问题。
解决办法是在第二次划分的时候把数据缓存到共享内存，进一步的划分则直接从共享内存中读取一小块，降低数据延迟。
